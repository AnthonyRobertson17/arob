<%= turbo_frame_tag exercise do %>
  <div class="card mb-3">
    <div class="card-body">
      <%= turbo_frame_tag dom_id(exercise, :edit) do %>
        <div class="d-flex align-items-center mb-3">
          <h4 class="h4 mb-0 flex-grow-1"><%= exercise.exercise_type.name %></h4>
          <%= button_to(t(".move_up"),
                        swap_position_workout_exercise_path(workout, exercise),
                        method: :patch,
                        params: { position: exercise.position - 1 },
                        form: { data: { turbo_frame: dom_id(exercise), } },
                        disabled: exercise.position.zero?,
                        class: "btn btn-primary me-2") %>
          <%= button_to(t(".move_down"),
                        swap_position_workout_exercise_path(workout, exercise),
                        method: :patch,
                        params: { position: exercise.position + 1 },
                        form: { data: { turbo_frame: dom_id(exercise), } },
                        disabled: workout.last_exercise?(exercise),
                        class: "btn btn-primary me-2") %>
          <%= link_to(t(:edit),
                      [:edit, workout, exercise],
                      class: "btn btn-secondary me-2") %>
          <%= button_to(t(:destroy),
                        [workout, exercise],
                        method: :delete,
                        form: {
                          data: {
                            turbo_confirm: t(".destroy_confirmation"),
                            turbo_frame: dom_id(exercise),
                          }
                        },
                        class: "btn btn-danger") %>
        </div>
        <% unless exercise.note.blank? %>
          <div class="mb-3">
            <p class="fw-bold mb-1"><%= Exercise.human_attribute_name("note") %>:</p>
            <%= simple_format(exercise.note) %>
          </div>
        <% end %>
      <% end %>

      <%= turbo_frame_tag nested_dom_id(exercise, "exercise_sets") do %>
        <%= render exercise.exercise_sets, workout: workout, exercise: exercise %>
      <% end %>

      <%= turbo_frame_tag nested_dom_id(exercise, ExerciseSet.new) %>

      <% unless workout.completed? %>
      <%= link_to t(".create_exercise_set"),
                  [:new, workout, exercise, :exercise_set],
                  class: "btn btn-primary",
                  data: { turbo_frame: nested_dom_id(exercise, ExerciseSet.new) } %>
      <% end %>
    </div>
  </div>
<% end %>
